<!DOCTYPE html><html><head><title>Automated Survey</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Automated Survey"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Automated Survey</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Instantly collect structured data from your users with a survey conducted over a voice call or SMS text messages. Let's get started!</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Automated Survey" class="chapter"><div data-file="automated_survey/models.py" class="step"><h2 id="what-does-this-thing-do-">What does this thing do?</h2>
<p>This <a href="https://www.djangoproject.com/">Django</a> web application
shows how you can use Twilio to conduct a survey over a phone call.</p>
<p>In this tutorial, we&#39;ll point out the key bits of code that make this
application work. <a href="https://github.com/TwilioDevEd/automated-survey-django">Check out the project README on GitHub</a>
to see how to run the code yourself.</p>
<p>Let&#39;s get started! Click the right arrow above to move to the next
step of the tutorial.</p>
<hr>
<p><strong>See also</strong></p>
<ul>
<li><a href="https://twilio-python.readthedocs.org/en/latest/">Twilio Python Helper Library</a></li>
<li><a href="https://www.twilio.com/docs/quickstart/python/twiml">TwiML Python Quickstart Tutorial</a></li>
<li><a href="https://docs.djangoproject.com/en/1.8/ref/">Django docs</a></li>
</ul>
</div><div data-file="automated_survey/models.py" data-highlight="1-27" class="step"><h2 id="the-survey-and-question-models">The Survey and Question models</h2>
<p>Our <code>Survey</code> and <code>Question</code> models store the content of the surveys our
users will hear when they call our Twilio number. A survey can have
multiple questions, and we support three different kinds of responses:</p>
<ul>
<li><code>VOICE</code>: Records an audio response from the caller</li>
<li><code>YES_NO</code>: Uses the 1 key for &#39;yes&#39; or the 0 key for &#39;no&#39;</li>
<li><code>NUMERIC</code>: Uses a 1-10 rating scale</li>
</ul>
<p>Our application comes with a sample survey for you to try about
<a href="https://www.youtube.com/watch?v=WaaANll8h18">bears, beets, and Battlestar Galactica</a>.</p>
<hr>
<p><strong>See also</strong></p>
<ul>
<li><a href="https://docs.djangoproject.com/en/1.8/topics/db/models/">Django models</a></li>
<li><a href="https://docs.djangoproject.com/en/1.8/ref/models/fields/#choices">Django choices model attribute</a></li>
</ul>
</div><div data-file="automated_survey/views/surveys.py" data-highlight="45-50" class="step"><h2 id="respond-to-a-phone-call">Respond to a Phone Call</h2>
<p>Whenever someone calls our Twilio number, Twilio will send a POST request
to the URL you configured when you bought that number. For this app, that
URL should be <code>/automated-survey/first-survey/</code>.</p>
<p>Our app begins the call by finding the first <code>Survey</code> in our database
and redirecting to a view that will begin the survey for our caller.
Let&#39;s look at that view next.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="https://www.twilio.com/docs/api/twiml/your_response">Twilio is a well-behaved HTTP client</a></li>
<li><a href="https://docs.djangoproject.com/en/1.8/ref/request-response/#django.http.HttpResponseRedirect">Django HttpResponseRedirect</a></li>
</ul>
</div><div data-file="automated_survey/views/surveys.py" data-highlight="24-42" class="step"><h2 id="welcome-the-caller-to-the-survey">Welcome the caller to the survey</h2>
<p>The way you tell Twilio how to respond to incoming phone calls is by
using <a href="https://www.twilio.com/docs/api/twiml">TwiML</a>.</p>
<p>Our first TwiML response welcomes the caller to the survey. We
use the <a href="https://www.twilio.com/docs/api/twiml/say"><code>&lt;Say&gt;</code></a> verb to have
Twilio read the caller our welcome message. The
<a href="https://www.twilio.com/docs/api/twiml/redirect"><code>&lt;Redirect&gt;</code></a> verb tells
Twilio where to find the next TwiML instructions - in our case, a URL
for the first question.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="https://twilio-python.readthedocs.org/en/latest/usage/twiml.html">Creating TwiML with twilio-python</a></li>
<li><a href="https://www.twilio.com/docs/api/twiml/your_response">TwiML Voice: Your Response</a></li>
</ul>
</div><div data-file="automated_survey/views/questions.py" data-highlight="10-39" class="step"><h2 id="ask-the-caller-a-question">Ask the caller a question</h2>
<p>For each question in the survey, we build a TwiML response to tell Twilio
how to ask the question.</p>
<p>We use <a href="https://www.twilio.com/docs/api/twiml/say"><code>&lt;Say&gt;</code></a> again to read
the question and some instructions for how the caller should answer. The
last part of our TwiML depends on what kind of question we&#39;re asking,
using either a <a href="https://www.twilio.com/docs/api/twiml/record"><code>&lt;Record&gt;</code></a>
or <a href="https://www.twilio.com/docs/api/twiml/gather"><code>&lt;Gather&gt;</code></a> verb.</p>
<p>The <code>action</code> argument of those verbs is the URL in our application where
we want to receive the caller&#39;s answer. Let&#39;s look at that view next.</p>
</div><div data-file="automated_survey/views/question_responses.py" data-highlight="11-43" class="step"><h2 id="store-a-caller-s-answer-to-a-question">Store a caller&#39;s answer to a question</h2>
<p>When the caller finishes answering a question, Twilio will make a
POST request to this view.</p>
<p>In a helper method we create a new <code>QuestionResponse</code> object using the
POST data of Twilio&#39;s request to store some data about the call.</p>
<p>We use another helper method to set the <code>response</code> attribute on that
object with the caller&#39;s answer to the question. Depending on the kind of
question, we use the POST data&#39;s <code>Digits</code> or <code>RecordingUrl</code> key.</p>
<hr>
<p><strong>See also</strong></p>
<ul>
<li><a href="https://www.twilio.com/docs/api/twiml/twilio_request">TwiML Voice: Twilio&#39;s Request</a></li>
</ul>
</div><div data-file="automated_survey/views/question_responses.py" data-highlight="45-67" class="step"><h2 id="redirect-the-user-to-the-next-question">Redirect the user to the next question</h2>
<p>After we record the caller&#39;s response, we redirect Twilio to get TwiML for
the next question.</p>
<p>In a helper method, we use the Django ORM to get the set of questions for
this survey and find the next one based on the current question&#39;s <code>id</code> field.</p>
<p>Using these methods, our caller will progress through each question in
the survey until they&#39;ve answered them all. Then we wrap up the survey -
let&#39;s look at that next.</p>
<hr>
<p><strong>See Also:</strong> </p>
<ul>
<li><a href="https://docs.djangoproject.com/en/1.8/topics/db/queries/#related-objects">Django related objects</a></li>
<li><a href="https://docs.djangoproject.com/en/1.8/ref/urlresolvers/#reverse">Django reverse</a></li>
</ul>
</div><div data-file="automated_survey/views/question_responses.py" data-highlight="69-76" class="step"><h2 id="end-the-survey">End the survey</h2>
<p>When we can&#39;t find another question for a caller to answer, we end the
survey with this code.</p>
<p>After thanking the caller for taking the survey, the <code>&lt;Hangup&gt;</code> TwiML verb
ends the call.</p>
<hr>
<p><strong>See Also:</strong> </p>
<ul>
<li><a href="https://www.twilio.com/docs/api/twiml/hangup">TwiML Voice: &lt;Hangup&gt;</a></li>
</ul>
</div><div data-file="automated_survey/views/surveys.py" data-highlight="10-21" class="step"><h2 id="display-survey-results">Display survey results</h2>
<p>The last part of our application is a web interface for the survey author
to review the responses.</p>
<p>This view uses the Django ORM to get all the <code>QuestionResponse</code> objects
for a survey and renders them in template. We use HTML5 <code>&lt;audio&gt;</code> tags to
play recorded responses.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="https://docs.djangoproject.com/en/1.8/topics/db/queries/">Django queries</a></li>
<li><a href="https://docs.djangoproject.com/en/1.8/topics/db/queries/#lookups-that-span-relationships">Django queries that span relationships</a></li>
<li><a href="https://docs.djangoproject.com/en/1.8/topics/templates/">Django templates</a></li>
</ul>
</div><div class="step"><h2 id="where-to-next-">Where to next?</h2>
<p>That&#39;s it! Our Django application can now administer surveys to people who
call our Twilio number, and survey authors can view the results on the
web.</p>
<p>If you&#39;re a Python developer working with Twilio, you might also enjoy
these tutorials:</p>
<p><a href="https://www.twilio.com/docs/howto/walkthrough/click-to-call/python/flask"><strong>Click-To-Call (Flask)</strong></a></p>
<p>Put a button on your web page that connects visitors to live support or
sales people via telephone.</p>
<p><a href="https://www.twilio.com/docs/howto/walkthrough/call-tracking/python/django"><strong>Call Tracking (Django)</strong></a></p>
<p>Measure the effectiveness of different marketing campaigns. By assigning
a unique phone number to different advertisements, you can track which
ones have the best call rates and get some data about the callers
themselves.</p>
<h3 id="did-this-help-">Did this help?</h3>
<p>Thanks for checking out this tutorial! If you have any feedback
to share with us, we&#39;d love to hear it. Tweet
<a href="http://twitter.com/twilio">@twilio</a> to let us know what you
think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="automated_survey/models.py" data-mode="python">ZnJvbSBkamFuZ28uZGIgaW1wb3J0IG1vZGVscwoKCmNsYXNzIFN1cnZleShtb2RlbHMuTW9kZWwpOgogICAgdGl0bGUgPSBtb2RlbHMuQ2hhckZpZWxkKG1heF9sZW5ndGg9MjU1KQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnJXMnICUgc2VsZi50aXRsZQoKCmNsYXNzIFF1ZXN0aW9uKG1vZGVscy5Nb2RlbCk6CiAgICBWT0lDRSA9ICd2b2ljZScKICAgIFlFU19OTyA9ICd5ZXMtbm8nCiAgICBOVU1FUklDID0gJ251bWVyaWMnCgogICAgUVVFU1RJT05fS0lORF9DSE9JQ0VTID0gKAogICAgICAgIChWT0lDRSwgJ1ZvaWNlJyksCiAgICAgICAgKFlFU19OTywgJ1llcyBvciBubycpLAogICAgICAgIChOVU1FUklDLCAnTnVtZXJpYycpCiAgICApCgogICAgYm9keSA9IG1vZGVscy5DaGFyRmllbGQobWF4X2xlbmd0aD0yNTUpCiAgICBraW5kID0gbW9kZWxzLkNoYXJGaWVsZChtYXhfbGVuZ3RoPTI1NSwgY2hvaWNlcz1RVUVTVElPTl9LSU5EX0NIT0lDRVMpCiAgICBzdXJ2ZXkgPSBtb2RlbHMuRm9yZWlnbktleShTdXJ2ZXkpCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICclcycgJSBzZWxmLmJvZHkKCgpjbGFzcyBRdWVzdGlvblJlc3BvbnNlKG1vZGVscy5Nb2RlbCk6CiAgICByZXNwb25zZSA9IG1vZGVscy5DaGFyRmllbGQobWF4X2xlbmd0aD0yNTUpCiAgICBjYWxsX3NpZCA9IG1vZGVscy5DaGFyRmllbGQobWF4X2xlbmd0aD0yNTUpCiAgICBwaG9uZV9udW1iZXIgPSBtb2RlbHMuQ2hhckZpZWxkKG1heF9sZW5ndGg9MjU1KQogICAgcXVlc3Rpb24gPSBtb2RlbHMuRm9yZWlnbktleShRdWVzdGlvbikKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJyVzJyAlIHNlbGYucmVzcG9uc2UK</textarea>
<textarea class="saurus-file" data-file="automated_survey/views/surveys.py" data-mode="python">ZnJvbSBhdXRvbWF0ZWRfc3VydmV5Lm1vZGVscyBpbXBvcnQgU3VydmV5LCBRdWVzdGlvbiwgUXVlc3Rpb25SZXNwb25zZQpmcm9tIGRqYW5nby5odHRwIGltcG9ydCBIdHRwUmVzcG9uc2UsIEh0dHBSZXNwb25zZVJlZGlyZWN0CmZyb20gZGphbmdvLnZpZXdzLmdlbmVyaWMgaW1wb3J0IFZpZXcKZnJvbSBkamFuZ28uY29yZS51cmxyZXNvbHZlcnMgaW1wb3J0IHJldmVyc2UKZnJvbSBkamFuZ28uc2hvcnRjdXRzIGltcG9ydCByZW5kZXJfdG9fcmVzcG9uc2UKZnJvbSBkamFuZ28udmlld3MuZGVjb3JhdG9ycy5odHRwIGltcG9ydCByZXF1aXJlX1BPU1QsIHJlcXVpcmVfR0VUCmZyb20gdHdpbGlvIGltcG9ydCB0d2ltbAoKCkByZXF1aXJlX0dFVApkZWYgc2hvd19zdXJ2ZXlfcmVzdWx0cyhyZXF1ZXN0LCBzdXJ2ZXlfaWQpOgogICAgcmVzcG9uc2VzID0gUXVlc3Rpb25SZXNwb25zZS5vYmplY3RzLmZpbHRlcihxdWVzdGlvbl9fc3VydmV5X19pZD1zdXJ2ZXlfaWQpCiAgICBzdXJ2ZXkgPSBTdXJ2ZXkub2JqZWN0cy5nZXQoaWQ9c3VydmV5X2lkKQogICAgcmVzcG9uc2VzX3RvX3JlbmRlciA9IGxpc3QobWFwKGxhbWJkYSBxcjogX3RvX3Jlc3BvbnNlKHFyKSwgcmVzcG9uc2VzKSkKCiAgICB0ZW1wbGF0ZV9jb250ZXh0ID0gewogICAgICAgICdyZXNwb25zZXMnOiByZXNwb25zZXNfdG9fcmVuZGVyLAogICAgICAgICdzdXJ2ZXlfdGl0bGUnOiBzdXJ2ZXkudGl0bGUKICAgIH0KCiAgICByZXR1cm4gcmVuZGVyX3RvX3Jlc3BvbnNlKCdyZXN1bHRzLmh0bWwnLCBjb250ZXh0PXRlbXBsYXRlX2NvbnRleHQpCgoKQHJlcXVpcmVfR0VUCmRlZiBzaG93X3N1cnZleShyZXF1ZXN0LCBzdXJ2ZXlfaWQpOgogICAgc3VydmV5ID0gU3VydmV5Lm9iamVjdHMuZ2V0KGlkPXN1cnZleV9pZCkKICAgIGZpcnN0X3F1ZXN0aW9uID0gUXVlc3Rpb24ub2JqZWN0cy5vcmRlcl9ieSgnaWQnKS5maXJzdCgpCgogICAgZmlyc3RfcXVlc3Rpb25faWRzID0gewogICAgICAgICdzdXJ2ZXlfaWQnOiBzdXJ2ZXkuaWQsCiAgICAgICAgJ3F1ZXN0aW9uX2lkJzogZmlyc3RfcXVlc3Rpb24uaWQKICAgIH0KCiAgICBmaXJzdF9xdWVzdGlvbl91cmwgPSByZXZlcnNlKCdxdWVzdGlvbicsIGt3YXJncz1maXJzdF9xdWVzdGlvbl9pZHMpCiAgICB2b2ljZV9yZXNwb25zZSA9IHR3aW1sLlJlc3BvbnNlKCkKCiAgICB2b2ljZV9yZXNwb25zZS5zYXkoCiAgICAgICAgJ0hlbGxvIGFuZCB0aGFuayB5b3UgZm9yIHRha2luZyB0aGUgJXMgc3VydmV5JyAlCiAgICAgICAgc3VydmV5LnRpdGxlKQogICAgdm9pY2VfcmVzcG9uc2UucmVkaXJlY3QoZmlyc3RfcXVlc3Rpb25fdXJsLCBtZXRob2Q9J0dFVCcpCgogICAgcmV0dXJuIEh0dHBSZXNwb25zZSh2b2ljZV9yZXNwb25zZSwgY29udGVudF90eXBlPSdhcHBsaWNhdGlvbi94bWwnKQoKCkByZXF1aXJlX1BPU1QKZGVmIHJlZGlyZWN0X3RvX2ZpcnN0X3N1cnZleShyZXF1ZXN0KToKICAgIGZpcnN0X3N1cnZleSA9IFN1cnZleS5vYmplY3RzLmZpcnN0KCkKICAgIGZpcnN0X3N1cnZleV91cmwgPSByZXZlcnNlKCdzdXJ2ZXknLCBrd2FyZ3M9eydzdXJ2ZXlfaWQnOiBmaXJzdF9zdXJ2ZXkuaWR9KQoKICAgIHJldHVybiBIdHRwUmVzcG9uc2VSZWRpcmVjdChmaXJzdF9zdXJ2ZXlfdXJsKQoKCkByZXF1aXJlX0dFVApkZWYgcmVkaXJlY3RfdG9fZmlyc3RfcmVzdWx0cyhyZXF1ZXN0KToKICAgIGZpcnN0X3N1cnZleSA9IFN1cnZleS5vYmplY3RzLmZpcnN0KCkKICAgIHJlc3VsdHNfZm9yX2ZpcnN0X3N1cnZleSA9IHJldmVyc2UoCiAgICAgICAgJ3N1cnZleV9yZXN1bHRzJywga3dhcmdzPXsKICAgICAgICAgICAgJ3N1cnZleV9pZCc6IGZpcnN0X3N1cnZleS5pZH0pCiAgICByZXR1cm4gSHR0cFJlc3BvbnNlUmVkaXJlY3QocmVzdWx0c19mb3JfZmlyc3Rfc3VydmV5KQoKCmRlZiBfdG9fcmVzcG9uc2UocXVlc3Rpb25fcmVzcG9uc2UpOgogICAgcmV0dXJuIHsKICAgICAgICAnYm9keSc6IHF1ZXN0aW9uX3Jlc3BvbnNlLnF1ZXN0aW9uLmJvZHksCiAgICAgICAgJ2tpbmQnOiBxdWVzdGlvbl9yZXNwb25zZS5xdWVzdGlvbi5raW5kLAogICAgICAgICdyZXNwb25zZSc6IHF1ZXN0aW9uX3Jlc3BvbnNlLnJlc3BvbnNlLAogICAgICAgICdjYWxsX3NpZCc6IHF1ZXN0aW9uX3Jlc3BvbnNlLmNhbGxfc2lkLAogICAgICAgICdwaG9uZV9udW1iZXInOiBxdWVzdGlvbl9yZXNwb25zZS5waG9uZV9udW1iZXIsCiAgICB9Cg==</textarea>
<textarea class="saurus-file" data-file="automated_survey/views/questions.py" data-mode="python">ZnJvbSBkamFuZ28uY29yZS51cmxyZXNvbHZlcnMgaW1wb3J0IHJldmVyc2UKZnJvbSB0d2lsaW8gaW1wb3J0IHR3aW1sCmZyb20gZGphbmdvLmh0dHAgaW1wb3J0IEh0dHBSZXNwb25zZQoKZnJvbSBhdXRvbWF0ZWRfc3VydmV5Lm1vZGVscyBpbXBvcnQgUXVlc3Rpb24KZnJvbSBhdXRvbWF0ZWRfc3VydmV5LnZpZXdzLmNvbW1vbiBpbXBvcnQgcGFyYW1ldGVyc19mb3Jfc3VydmV5X3VybApmcm9tIGRqYW5nby52aWV3cy5kZWNvcmF0b3JzLmh0dHAgaW1wb3J0IHJlcXVpcmVfR0VUCgoKQHJlcXVpcmVfR0VUCmRlZiBzaG93X3F1ZXN0aW9uKHJlcXVlc3QsIHN1cnZleV9pZCwgcXVlc3Rpb25faWQpOgogICAgcXVlc3Rpb24gPSBRdWVzdGlvbi5vYmplY3RzLmdldChpZD1xdWVzdGlvbl9pZCkKCiAgICB1cmxfcGFyYW1ldGVycyA9IHBhcmFtZXRlcnNfZm9yX3N1cnZleV91cmwocXVlc3Rpb24uc3VydmV5LmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uLmlkKQoKICAgIHF1ZXN0aW9uX3N0b3JlX3VybCA9IHJldmVyc2UoJ3JlY29yZF9yZXNwb25zZScsIGt3YXJncz11cmxfcGFyYW1ldGVycykKCiAgICB2b2ljZV9yZXNwb25zZSA9IHR3aW1sLlJlc3BvbnNlKCkKICAgIHZvaWNlX3Jlc3BvbnNlLnNheShxdWVzdGlvbi5ib2R5KQogICAgdm9pY2VfcmVzcG9uc2Uuc2F5KGluc3RydWN0aW9uc1txdWVzdGlvbi5raW5kXSkKICAgIHZvaWNlX3Jlc3BvbnNlID0gX2F0dGFjaF9jb21tYW5kX3RvX3Jlc3BvbnNlKAogICAgICAgIHZvaWNlX3Jlc3BvbnNlLCBxdWVzdGlvbi5raW5kLCBxdWVzdGlvbl9zdG9yZV91cmwKICAgICkKCiAgICByZXR1cm4gSHR0cFJlc3BvbnNlKHZvaWNlX3Jlc3BvbnNlLCBjb250ZW50X3R5cGU9J2FwcGxpY2F0aW9uL3htbCcpCgoKZGVmIF9hdHRhY2hfY29tbWFuZF90b19yZXNwb25zZShyZXNwb25zZSwga2luZCwgYWN0aW9uKToKICAgIGlmIGtpbmQgPT0gUXVlc3Rpb24uVk9JQ0U6CiAgICAgICAgcmVzcG9uc2UucmVjb3JkKGFjdGlvbj1hY3Rpb24gKyAnP0tpbmQ9dm9pY2UnLCBtZXRob2Q9J1BPU1QnKQogICAgZWxpZiBraW5kID09IFF1ZXN0aW9uLk5VTUVSSUM6CiAgICAgICAgcmVzcG9uc2UuZ2F0aGVyKGFjdGlvbj1hY3Rpb24gKyAnP0tpbmQ9bnVtZXJpYycsIG1ldGhvZD0nUE9TVCcpCiAgICBlbGlmIGtpbmQgPT0gUXVlc3Rpb24uWUVTX05POgogICAgICAgIHJlc3BvbnNlLmdhdGhlcihhY3Rpb249YWN0aW9uICsgJz9LaW5kPXllcy1ubycsIG1ldGhvZD0nUE9TVCcpCiAgICBlbHNlOgogICAgICAgIHJhaXNlIE5vU3VjaFZlcmJFeGNlcHRpb24oJyVzIGlzIG5vdCBhIHN1cHBvcnRlZCBxdWVzdGlvbiB0eXBlJyAlIGtpbmQpCgogICAgcmV0dXJuIHJlc3BvbnNlCgppbnN0cnVjdGlvbnMgPSB7CiAgICAndm9pY2UnOiAnUGxlYXNlIHJlY29yZCB5b3VyIGFuc3dlciBhZnRlciB0aGUgYmVlcCBhbmQgdGhlbiBoaXQgdGhlIHBvdW5kIHNpZ24nLAogICAgJ3llcy1ubyc6ICdQbGVhc2UgcHJlc3MgdGhlIG9uZSBrZXkgZm9yIHllcyBhbmQgdGhlIHplcm8ga2V5IGZvciBubyBhbmQgdGhlbiBoaXQgdGhlIHBvdW5kIHNpZ24nLAogICAgJ251bWVyaWMnOiAnUGxlYXNlIHByZXNzIGEgbnVtYmVyIGJldHdlZW4gMSBhbmQgMTAgYW5kIHRoZW4gaGl0IHRoZSBwb3VuZCBzaWduJwp9CgoKY2xhc3MgTm9TdWNoVmVyYkV4Y2VwdGlvbihFeGNlcHRpb24pOgogICAgcGFzcwo=</textarea>
<textarea class="saurus-file" data-file="automated_survey/views/question_responses.py" data-mode="python">ZnJvbSBkamFuZ28udmlld3MuZ2VuZXJpYyBpbXBvcnQgVmlldwpmcm9tIGRqYW5nby5jb3JlLnVybHJlc29sdmVycyBpbXBvcnQgcmV2ZXJzZQpmcm9tIGRqYW5nby5zaG9ydGN1dHMgaW1wb3J0IHJlZGlyZWN0CmZyb20gZGphbmdvLmh0dHAgaW1wb3J0IEh0dHBSZXNwb25zZQpmcm9tIHR3aWxpbyBpbXBvcnQgdHdpbWwKCmZyb20gYXV0b21hdGVkX3N1cnZleS5tb2RlbHMgaW1wb3J0IFN1cnZleSwgUXVlc3Rpb25SZXNwb25zZSwgUXVlc3Rpb24KZnJvbSBhdXRvbWF0ZWRfc3VydmV5LnZpZXdzLmNvbW1vbiBpbXBvcnQgcGFyYW1ldGVyc19mb3Jfc3VydmV5X3VybAoKCmNsYXNzIFF1ZXN0aW9uUmVzcG9uc2VWaWV3KFZpZXcpOgogICAgaHR0cF9tZXRob2RfbmFtZXMgPSBbJ3Bvc3QnXQoKICAgIGRlZiBwb3N0KHNlbGYsIHJlcXVlc3QsIHN1cnZleV9pZCwgcXVlc3Rpb25faWQpOgogICAgICAgIHF1ZXN0aW9uX2tpbmQgPSByZXF1ZXN0LkdFVC5nZXQoJ0tpbmQnKQogICAgICAgIGlmIHF1ZXN0aW9uX2tpbmQgbm90IGluIFsneWVzLW5vJywgJ251bWVyaWMnLCAndm9pY2UnXToKICAgICAgICAgICAgcmFpc2UgTm9TdWNoUXVlc3Rpb25LaW5kRXhjZXB0aW9uCgogICAgICAgIG5ld19yZXNwb25zZSA9IHNlbGYuX3F1ZXN0aW9uX3Jlc3BvbnNlX2Zyb21fcmVxdWVzdChyZXF1ZXN0KQogICAgICAgIG5ld19yZXNwb25zZS5xdWVzdGlvbl9pZCA9IHF1ZXN0aW9uX2lkCiAgICAgICAgbmV3X3Jlc3BvbnNlLnNhdmUoKQoKICAgICAgICByZXR1cm4gc2VsZi5fcmVkaXJlY3RfZm9yX25leHRfcXVlc3Rpb24oc3VydmV5X2lkLCBxdWVzdGlvbl9pZCkKCiAgICBkZWYgX3F1ZXN0aW9uX3Jlc3BvbnNlX2Zyb21fcmVxdWVzdChzZWxmLCByZXF1ZXN0KToKICAgICAgICBxdWVzdGlvbl9raW5kID0gcmVxdWVzdC5HRVQuZ2V0KCdLaW5kJykKICAgICAgICAoY2FsbF9zaWQsIHBob25lX251bWJlcikgPSAocmVxdWVzdC5QT1NUWydDYWxsU2lkJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QuUE9TVFsnRnJvbSddKQoKICAgICAgICBuZXdfcmVzcG9uc2UgPSBRdWVzdGlvblJlc3BvbnNlKAogICAgICAgICAgICBjYWxsX3NpZD1jYWxsX3NpZCwgcGhvbmVfbnVtYmVyPXBob25lX251bWJlcikKICAgICAgICBuZXdfcmVzcG9uc2UucmVzcG9uc2UgPSBzZWxmLl9xdWVzdGlvbl9yZXNwb25zZV9jb250ZW50KAogICAgICAgICAgICByZXF1ZXN0LCBxdWVzdGlvbl9raW5kKQoKICAgICAgICByZXR1cm4gbmV3X3Jlc3BvbnNlCgogICAgZGVmIF9xdWVzdGlvbl9yZXNwb25zZV9jb250ZW50KHNlbGYsIHJlcXVlc3QsIHF1ZXN0aW9uX2tpbmQpOgogICAgICAgIGlmIHF1ZXN0aW9uX2tpbmQgaW4gW1F1ZXN0aW9uLllFU19OTywgUXVlc3Rpb24uTlVNRVJJQ106CiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LlBPU1RbJ0RpZ2l0cyddCiAgICAgICAgZWxpZiBxdWVzdGlvbl9raW5kID09IFF1ZXN0aW9uLlZPSUNFOgogICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5QT1NUWydSZWNvcmRpbmdVcmwnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIE5vU3VjaFF1ZXN0aW9uS2luZEV4Y2VwdGlvbgoKICAgIGRlZiBfcmVkaXJlY3RfZm9yX25leHRfcXVlc3Rpb24oc2VsZiwgc3VydmV5X2lkLCBxdWVzdGlvbl9pZCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBuZXh0X3F1ZXN0aW9uID0gc2VsZi5fbmV4dF9xdWVzdGlvbihzdXJ2ZXlfaWQsIHF1ZXN0aW9uX2lkKQogICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZ29vZGJ5ZV9tZXNzYWdlKCkKCiAgICAgICAgdXJsX3BhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzX2Zvcl9zdXJ2ZXlfdXJsKAogICAgICAgICAgICBuZXh0X3F1ZXN0aW9uLnN1cnZleV9pZCwgbmV4dF9xdWVzdGlvbi5pZCkKICAgICAgICBuZXh0X3F1ZXN0aW9uX3VybCA9IHJldmVyc2UoJ3F1ZXN0aW9uJywga3dhcmdzPXVybF9wYXJhbWV0ZXJzKQoKICAgICAgICBzZWVfb3RoZXIgPSByZWRpcmVjdChuZXh0X3F1ZXN0aW9uX3VybCkKICAgICAgICBzZWVfb3RoZXIuc3RhdHVzX2NvZGUgPSAzMDMKICAgICAgICBzZWVfb3RoZXIucmVhc29uX3BocmFzZSA9ICdTZWUgT3RoZXInCgogICAgICAgIHJldHVybiBzZWVfb3RoZXIKCiAgICBkZWYgX25leHRfcXVlc3Rpb24oc2VsZiwgc3VydmV5X2lkLCBxdWVzdGlvbl9pZCk6CiAgICAgICAgc3VydmV5ID0gU3VydmV5Lm9iamVjdHMuZ2V0KGlkPXN1cnZleV9pZCkKCiAgICAgICAgcXVlc3Rpb25zID0gc3VydmV5LnF1ZXN0aW9uX3NldC5vcmRlcl9ieSgnaWQnKQogICAgICAgIG5leHRfcXVlc3Rpb25zID0gZmlsdGVyKGxhbWJkYSBxOiBxLmlkID4gaW50KHF1ZXN0aW9uX2lkKSwgcXVlc3Rpb25zKQoKICAgICAgICByZXR1cm4gbGlzdChuZXh0X3F1ZXN0aW9ucylbMF0KCiAgICBkZWYgX2dvb2RieWVfbWVzc2FnZShzZWxmKToKICAgICAgICB2b2ljZV9yZXNwb25zZSA9IHR3aW1sLlJlc3BvbnNlKCkKICAgICAgICB2b2ljZV9yZXNwb25zZS5zYXkoJ1RoYXQgd2FzIHRoZSBsYXN0IHF1ZXN0aW9uJykKICAgICAgICB2b2ljZV9yZXNwb25zZS5zYXkoJ1RoYW5rIHlvdSBmb3IgdGFraW5nIHRoaXMgc3VydmV5JykKICAgICAgICB2b2ljZV9yZXNwb25zZS5zYXkoJ0dvb2QtYnllJykKICAgICAgICB2b2ljZV9yZXNwb25zZS5oYW5ndXAoKQoKICAgICAgICByZXR1cm4gSHR0cFJlc3BvbnNlKHZvaWNlX3Jlc3BvbnNlKQoKCmNsYXNzIE5vU3VjaFF1ZXN0aW9uS2luZEV4Y2VwdGlvbihFeGNlcHRpb24pOgogICAgcGFzcwo=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/automated-survey-django" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>